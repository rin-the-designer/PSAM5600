claude-4-sonnet

Build a web-based MIDI drum pad using the Strudel Web package (https://codeberg.org/uzu/strudel/src/branch/main/packages/web) with a 4×4 dark-mode UI inspired by Teenage Engineering (IBM Plex Mono, boxed/outlined brutalist grid, bold borders, zero border-radius). Map keys exactly to “1234qwerasdfzxcv” (e.g., “q” = column 1, row 2). CRITICAL: ensure audio always plays by creating a single shared Web Audio AudioContext({ latencyHint: "interactive" }) and resuming it on the first user gesture (click/touch/keydown) before any playback; preload all sample one-shots at load time via fetch + decodeAudioData into a Map<string, AudioBuffer>; on each pad hit create a fresh AudioBufferSourceNode per voice (never reuse sources), connect to a per-pad GainNode (with a short envelope: attack ≈ 0–2 ms, release ≈ 120–200 ms to avoid clicks), then to the master; allow full polyphony and overlapping hits; on mobile Safari gate playback behind a user gesture and call context.resume() on visibility changes. Default .bank("tr909") and expose a Settings page listing Strudel’s available banks (pull via Strudel’s API) so the user can select sounds; persist selection to localStorage. The UI has: (1) the 4×4 pad grid (click or mapped key triggers immediate sample playback with zero additional async work), (2) a BPM numeric input, (3) a Play/Stop transport button, (4) a minimal Strudel code panel that mirrors interactions. When a pad is clicked or a mapped key is pressed: (a) trigger its assigned sample immediately (buffer-based), and (b) append/reflect the corresponding Strudel snippet in the editor (e.g., add that hit to the current pattern line); multiple simultaneous presses must fire together. Provide a “Basic 8-beat” example in the editor: $: s("hh\*4, bd sd").bank("tr909"). The Play button evaluates whatever is in the Strudel editor, while individual pad hits always play directly via the Web Audio buffers (no dependency on the transport). Implement robust error handling: if a sample fails to decode, show a non-blocking toast and disable only that pad; if AudioContext is suspended, show a one-time “Enable Sound” overlay that calls resume() on click. Visually highlight pads on hit, support mouse/touch/keyboard input, and debounce repeated keydown autorepeat so each press yields a single hit unless the key is physically re-pressed.
